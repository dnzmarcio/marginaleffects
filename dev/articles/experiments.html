<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="marginaleffects">
<title>Experiments: 2x2 designs and regression adjustment • marginaleffects</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Experiments: 2x2 designs and regression adjustment">
<meta property="og:description" content="marginaleffects">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">marginaleffects</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.12.0.9008</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/marginaleffects.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vincentarelbundock/marginaleffects/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Experiments: 2x2 designs and regression adjustment</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/vincentarelbundock/marginaleffects/blob/HEAD/vignettes/experiments.Rmd" class="external-link"><code>vignettes/experiments.Rmd</code></a></small>
      <div class="d-none name"><code>experiments.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="analyzing-2x2-experiments-with-marginaleffects">Analyzing 2x2 Experiments with <code>marginaleffects</code><a class="anchor" aria-label="anchor" href="#analyzing-2x2-experiments-with-marginaleffects"></a>
</h2>
<p>A 2×2 factorial design is a type of experimental design that allows
researchers to understand the effects of two independent variables (each
with two levels) on a single dependent variable. The design is popular
among academic researchers as well as in industry when running A/B
tests.</p>
<p>To illustrate how to analyze these designs with
<code>marginaleffects</code>, we will use the <code>mtcars</code>
dataset. We’ll analyze fuel efficiency, <code>mpg</code> (miles per
gallon), as a function of <code>am</code> (transmission type) and
<code>vs</code> (engine shape).</p>
<p><code>vs</code> is an indicator variable for if the car has a
straight engine (1 = straight engine, 0 = V-shaped). <code>am</code> is
an indicator variable for if the car has manual transmission (1 = manual
transmission, 0=automatic transmission). There are then four types of
cars (1 type for each of the four combinations of binary
indicators).</p>
<div class="section level3">
<h3 id="fitting-a-model">Fitting a Model<a class="anchor" aria-label="anchor" href="#fitting-a-model"></a>
</h3>
<p>Let’s start by creating a model for fuel efficiency. For simplicity,
we’ll use linear regression and model the interaction between
<code>vs</code> and <code>am</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/marginaleffects/">marginaleffects</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># See ?mtcars for variable definitions</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">vs</span> <span class="op">+</span> <span class="va">am</span> <span class="op">+</span> <span class="va">vs</span><span class="op">:</span><span class="va">am</span>, data<span class="op">=</span><span class="va">mtcars</span><span class="op">)</span> <span class="co"># equivalent to ~ vs*am</span></span></code></pre></div>
<p>We can plot the predictions from the model using the
<code>plot_predictions</code> function. From the plot below, we can see
a few things:</p>
<ul>
<li>Straight engines (<code>vs=1</code>) are estimated to have better
expected fuel efficiency than V-shaped engines (<code>vs=0</code>).</li>
<li>Manual transmissions (<code>am=1</code>) are estimated to have
better fuel efficiency for both V-shaped and straight engines.</li>
<li>For straight engines, the effect of manual transmissions on fuel
efficiency seems to increase.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_predictions.html">plot_predictions</a></span><span class="op">(</span><span class="va">fit</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vs"</span>, <span class="st">"am"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="experiments_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="evaluating-effects-from-the-model-summary">Evaluating Effects From The Model Summary<a class="anchor" aria-label="anchor" href="#evaluating-effects-from-the-model-summary"></a>
</h3>
<p>Since this model is fairly simple the estimated differences between
any of the four possible combinations of <code>vs</code> and
<code>am</code> can be read from <code>summary(fit)</code> with a little
arithmetic. The estimated model is</p>
<p><span class="math display">\[ \mbox{mpg} = 20.743 + 5.693 \cdot
\mbox{vs} + 4.700 \cdot \mbox{am} + 2.929 \cdot \mbox{vs} \cdot
\mbox{am} \&gt;. \]</span></p>
<p>The estimated differences in fuel efficiency are:</p>
<ul>
<li>5.693 mpg between straight engines and V-shaped engines when the car
has automatic transmission.</li>
<li>4.700 mpg between manual transmissions and automatic transmissions
when the car has a V-shaped engine.</li>
<li>7.629 mpg between manual transmissions and automatic transmissions
when the car has a straight engine.</li>
<li>13.322 mpg between manual transmissions with straight engines and
automatic transmissions with V-shaped engines.</li>
</ul>
<p>Reading off these differences from the model summary becomes more
difficult as more variables are added (not to mention obtaining their
estimated standard errors becomes nightmarish). To make the process
easier on ourselves, we can leverage the <code>avg_comparisons</code>
function to get the same estimates and their uncertainty.</p>
</div>
<div class="section level3">
<h3 id="using-avg_comparisons-to-estimate-all-differences">Using <code>avg_comparisons</code> To Estimate All Differences<a class="anchor" aria-label="anchor" href="#using-avg_comparisons-to-estimate-all-differences"></a>
</h3>
<p>Note that the dot in the grey rectangle is the estimated fuel
efficiency when <code>vs=0</code> and <code>am=0</code> (that is, for an
automatic transmission car with V-shaped engine).</p>
<p><img src="experiments_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<p>Let’s use <code>avg_comparisons</code> to get the difference between
straight engines and V-shaped engines when the car has automatic
transmission. The call to <code>avg_comparisons</code> is shown below
and results in the same estimate we made directly from the model. The
contrast corresponding to this estimate is shown in the plot below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/comparisons.html">avg_comparisons</a></span><span class="op">(</span><span class="va">fit</span>,</span>
<span>  newdata <span class="op">=</span> <span class="fu"><a href="../reference/datagrid.html">datagrid</a></span><span class="op">(</span>am <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  variables <span class="op">=</span> <span class="st">"vs"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Term Contrast Estimate Std. Error    z Pr(&gt;|z|)    S 2.5 % 97.5 %</span></span>
<span><span class="co">#&gt;    vs    1 - 0     5.69       1.65 3.45   &lt;0.001 10.8  2.46   8.93</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Columns: rowid, term, contrast, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, predicted, predicted_hi, predicted_lo</span></span></code></pre></div>
<p><img src="experiments_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<p>The next difference is between manual transmissions and automatic
transmissions when the car has a V-shaped engine. Again, the call to
<code>avg_comparisons</code> is shown below, and the corresponding
contrast is indicated in the plot below using an arrow.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/comparisons.html">avg_comparisons</a></span><span class="op">(</span><span class="va">fit</span>,</span>
<span>  newdata <span class="op">=</span> <span class="fu"><a href="../reference/datagrid.html">datagrid</a></span><span class="op">(</span>vs <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  variables <span class="op">=</span> <span class="st">"am"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Term Contrast Estimate Std. Error    z Pr(&gt;|z|)   S 2.5 % 97.5 %</span></span>
<span><span class="co">#&gt;    am    1 - 0      4.7       1.74 2.71  0.00678 7.2   1.3    8.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Columns: rowid, term, contrast, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, predicted, predicted_hi, predicted_lo</span></span></code></pre></div>
<p><img src="experiments_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<p>The third difference we estimated was between manual transmissions
and automatic transmissions when the car has a straight engine. The
model call and contrast are</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/comparisons.html">avg_comparisons</a></span><span class="op">(</span><span class="va">fit</span>,</span>
<span>  newdata <span class="op">=</span> <span class="fu"><a href="../reference/datagrid.html">datagrid</a></span><span class="op">(</span>vs <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  variables <span class="op">=</span> <span class="st">"am"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Term Contrast Estimate Std. Error    z Pr(&gt;|z|)    S 2.5 % 97.5 %</span></span>
<span><span class="co">#&gt;    am    1 - 0     7.63       1.86 4.11   &lt;0.001 14.6  3.99   11.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Columns: rowid, term, contrast, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, predicted, predicted_hi, predicted_lo</span></span></code></pre></div>
<p><img src="experiments_files/figure-html/unnamed-chunk-10-1.png" width="100%"></p>
<p>And the last difference and contrast between manual transmissions
with straight engines and automatic transmissions with V-shaped engines
is</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/comparisons.html">avg_comparisons</a></span><span class="op">(</span><span class="va">fit</span>,</span>
<span>  newdata <span class="op">=</span> <span class="fu"><a href="../reference/datagrid.html">datagrid</a></span><span class="op">(</span><span class="st">"vs"</span>, <span class="st">"am"</span><span class="op">)</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"am"</span>, <span class="st">"vs"</span><span class="op">)</span>,</span>
<span>  cross <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  C: am C: vs Estimate Std. Error    z Pr(&gt;|z|)    S 2.5 % 97.5 %</span></span>
<span><span class="co">#&gt;  1 - 0 1 - 0     13.3       1.65 8.07   &lt;0.001 50.3  10.1   16.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Columns: rowid, term, contrast_am, contrast_vs, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, predicted, predicted_hi, predicted_lo</span></span></code></pre></div>
<p><img src="experiments_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p>The 2x2 design is a very popular design, and when using a linear
model, the estimated differences between groups can be directly read off
from the model summary, if not with a little arithmetic. However, when
using models with a non-identity link function, or when seeking to
obtain the standard errors for estimated differences, things become
considerably more difficult. This vignette showed how to use
<code>avg_comparisons</code> to specify contrasts of interests and
obtain standard errors for those differences. The approach used applies
to all generalized linear models and effects can be further stratified
using the <code>by</code> argument (although this is not shown in this
vignette.)</p>
</div>
</div>
<div class="section level2">
<h2 id="regression-adjustment-in-experiments">Regression adjustment in experiments<a class="anchor" aria-label="anchor" href="#regression-adjustment-in-experiments"></a>
</h2>
<p>Many analysts who conduct and analyze experiments wish to use
regression adjustment with a linear regression model to improve the
precision of their estimate of the treatment effect. Unfortunately,
regression adjustment can introduce small-sample bias and other
undesirable properties (Freedman 2008). Lin (2013) proposes a simple
strategy to fix these problems in sufficiently large samples:</p>
<ol style="list-style-type: decimal">
<li>Center all predictors by subtracting each of their means.</li>
<li>Estimate a linear model in which the treatment is interacted with
each of the covariates.</li>
</ol>
<p>The <code>estimatr</code> package includes a convenient function to
implement this strategy:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://declaredesign.org/r/estimatr/" class="external-link">estimatr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/marginaleffects/">marginaleffects</a></span><span class="op">)</span></span>
<span><span class="va">lalonde</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"https://vincentarelbundock.github.io/Rdatasets/csv/MatchIt/lalonde.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/estimatr/reference/lm_lin.html" class="external-link">lm_lin</a></span><span class="op">(</span></span>
<span>    <span class="va">re78</span> <span class="op">~</span> <span class="va">treat</span>,</span>
<span>    covariates <span class="op">=</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span>,</span>
<span>    data <span class="op">=</span> <span class="va">lalonde</span>,</span>
<span>    se_type <span class="op">=</span> <span class="st">"HC3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm_lin(formula = re78 ~ treat, covariates = ~age + educ + race, </span></span>
<span><span class="co">#&gt;     data = lalonde, se_type = "HC3")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standard error type:  HC3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                    Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper  DF</span></span>
<span><span class="co">#&gt; (Intercept)         6488.05     356.71 18.1885 2.809e-59  5787.50   7188.6 604</span></span>
<span><span class="co">#&gt; treat                489.73     878.52  0.5574 5.774e-01 -1235.59   2215.0 604</span></span>
<span><span class="co">#&gt; age_c                 85.88      35.42  2.4248 1.561e-02    16.32    155.4 604</span></span>
<span><span class="co">#&gt; educ_c               464.04     131.51  3.5286 4.495e-04   205.77    722.3 604</span></span>
<span><span class="co">#&gt; racehispan_c        2775.47    1155.40  2.4022 1.660e-02   506.38   5044.6 604</span></span>
<span><span class="co">#&gt; racewhite_c         2291.67     793.30  2.8888 4.006e-03   733.71   3849.6 604</span></span>
<span><span class="co">#&gt; treat:age_c           17.23      76.37  0.2256 8.216e-01  -132.75    167.2 604</span></span>
<span><span class="co">#&gt; treat:educ_c         226.71     308.43  0.7350 4.626e-01  -379.02    832.4 604</span></span>
<span><span class="co">#&gt; treat:racehispan_c -1057.84    2652.42 -0.3988 6.902e-01 -6266.92   4151.2 604</span></span>
<span><span class="co">#&gt; treat:racewhite_c  -1205.68    1805.21 -0.6679 5.045e-01 -4750.92   2339.6 604</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.05722 ,   Adjusted R-squared:  0.04317 </span></span>
<span><span class="co">#&gt; F-statistic: 4.238 on 9 and 604 DF,  p-value: 2.424e-05</span></span></code></pre></div>
<p>We can obtain the same results by fitting a model with the standard
<code>lm</code> function and using the <code><a href="../reference/comparisons.html">comparisons()</a></code>
function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">re78</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">*</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">lalonde</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/comparisons.html">avg_comparisons</a></span><span class="op">(</span></span>
<span>    <span class="va">mod</span>,</span>
<span>    variables <span class="op">=</span> <span class="st">"treat"</span>,</span>
<span>    vcov <span class="op">=</span> <span class="st">"HC3"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Term Contrast Estimate Std. Error     z Pr(&gt;|z|)   S 2.5 % 97.5 %</span></span>
<span><span class="co">#&gt;  treat    1 - 0      490        879 0.557    0.577 0.8 -1232   2212</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Columns: term, contrast, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high</span></span></code></pre></div>
<p>Notice that the <code>treat</code> coefficient and associate standard
error in the <code>lm_lin</code> regression are exactly the same as the
estimates produced by the <code><a href="../reference/comparisons.html">comparisons()</a></code> function.</p>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ul>
<li>Freedman, David A. “On Regression Adjustments to Experimental Data.”
Advances in Applied Mathematics 40, no. 2 (February 2008): 180–93.</li>
<li>Lin, Winston. “Agnostic Notes on Regression Adjustments to
Experimental Data: Reexamining Freedman’s Critique.” Annals of Applied
Statistics 7, no. 1 (March 2013): 295–318. <a href="https://doi.org/10.1214/12-AOAS583" class="external-link uri">https://doi.org/10.1214/12-AOAS583</a>.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Vincent Arel-Bundock.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
